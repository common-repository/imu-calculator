function imucSubmitForm(a){jQuery.ajax({type:"POST",url:a+"/wp-admin/admin-ajax.php",data:jQuery("#imuc-calcoloimu").serialize(),beforeSend:function(){jQuery("#spinner").show()},success:function(a){jQuery("#spinner").hide();jQuery("#imuc-calcoloimu").find(".result").html(a)}});return false}function sanitizeNumber(a){a=a.toString().replace(/\jQuery|\./g,"");a=a.toString().replace(/\,/g,".");return a}function formatCurrency(a,b){if(b==undefined){b=true}else{b=false}if(b)a=sanitizeNumber(a);if(isNaN(a))a="0";sign=a==(a=Math.abs(a));a=Math.floor(a*100+.50000000001);cents=a%100;a=Math.floor(a/100).toString();if(cents<10)cents="0"+cents;for(var c=0;c<Math.floor((a.length-(1+c))/3);c++)a=a.substring(0,a.length-(4*c+3))+"."+a.substring(a.length-(4*c+3));return(sign?"":"-")+a+","+cents}function variazione_aliquota(a){var b=.6;var c=.2;var d=jQuery("#form_coefficiente").val();var e=jQuery("#form_aliquota").attr("rel");if(a==undefined&&e!=undefined&&e!=""){a=e}if(d=="FAC267"||d=="FAD10"){a=a==undefined?.2:a;b=.2;c=.1}else{a=a==undefined?.76:a;b=1.06;c=.46;if(jQuery(".prima_casa").is(":visible")){if(jQuery("#form_prima_casa_si").is(":checked")){a=a==undefined||a==.76?.4:a;b=.6;c=.2}}}if(a>b){a=b}if(a<c){a=c}jQuery("#form_aliquota").val(a);jQuery("#form_aliquota").change()}function controlla_contitolari(){var a=jQuery("#form_quota_possesso").val();if(jQuery("#form_prima_casa_si").is(":checked")&&jQuery("#form_coefficiente").val()=="A"){if(a<100){jQuery(".contitolari_row").show()}else{jQuery(".contitolari_row").hide();jQuery("#form_contitolari").val("2")}}else{jQuery(".contitolari_row").hide();jQuery("#form_contitolari").val("2")}}function transformTypedChar(a,b,c){if(b==undefined||b==null)b=",";if(c==undefined||c==null)c=".";return a==b?c:a}function getInputSelection(a){var b=0,c=0,d,e,f,g,h;if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){b=a.selectionStart;c=a.selectionEnd}else{e=document.selection.createRange();if(e&&e.parentElement()==a){g=a.value.length;d=a.value.replace(/\r\n/g,"\n");f=a.createTextRange();f.moveToBookmark(e.getBookmark());h=a.createTextRange();h.collapse(false);if(f.compareEndPoints("StartToEnd",h)>-1){b=c=g}else{b=-f.moveStart("character",-g);b+=d.slice(0,b).split("\n").length-1;if(f.compareEndPoints("EndToEnd",h)>-1){c=g}else{c=-f.moveEnd("character",-g);c+=d.slice(0,c).split("\n").length-1}}}}return{start:b,end:c}}function controllo_eta_figli(){var a=jQuery("#form_mesi_possesso").val();var b=jQuery("#form_n_figli").val();for(i=1;i<=b;i++){if(jQuery("#imuc_eta_figlio_"+i+" input").is(":visible")){if(jQuery("#imuc_eta_figlio_"+i+" input").val()>a){jQuery("#imuc_eta_figlio_"+i+" input").val(a)}}}}function offsetToRangeCharacterMove(a,b){return b-(a.value.slice(0,b).split("\r\n").length-1)}function setInputSelection(a,b,c){a.focus();if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){a.selectionStart=b;a.selectionEnd=c}else{var d=a.createTextRange();var e=offsetToRangeCharacterMove(a,b);d.collapse(true);if(b==c){d.move("character",e)}else{d.moveEnd("character",offsetToRangeCharacterMove(a,c));d.moveStart("character",e)}d.select()}}jQuery("document").ready(function(){jQuery("#spinner").hide();jQuery("#form_aliquota").keyup(function(){if(jQuery(this).val()!="0."&&jQuery(this).val()!="0"&&jQuery(this).val()!="."&&jQuery(this).val()!=""&&jQuery(this).val()!=undefined){variazione_aliquota(jQuery(this).val())}});jQuery("#form_rendita").keypress(function(a){if(a.which){var b=String.fromCharCode(a.which);var c=transformTypedChar(b,".",",");if(c!=b){var d=getInputSelection(this),e=this.value;this.value=e.slice(0,d.start)+c+e.slice(d.end);setInputSelection(this,d.start+1,d.start+1);return false}var f=a.which?a.which:event.keyCode;if(f>31&&(f<48||f>57)&&f!=44)return false}});jQuery("#form_aliquota,#form_quota_possesso").keypress(function(a){if(a.which){var b=String.fromCharCode(a.which);var c=transformTypedChar(b);if(c!=b){var d=getInputSelection(this),e=this.value;this.value=e.slice(0,d.start)+c+e.slice(d.end);setInputSelection(this,d.start+1,d.start+1);return false}var f=a.which?a.which:event.keyCode;if(f>31&&(f<48||f>57)&&f!=46)return false}});jQuery("#form_n_figli").keyup(function(){var a=jQuery(this).val();var b=jQuery("#form_mesi_possesso").val();if(a>8){jQuery(this).val(8);a=8}if(a>0){jQuery("#imuc_eta_figli").show()}else{jQuery("#imuc_eta_figli").hide()}jQuery(".imuc_eta_figli").hide();jQuery(".imuc_eta_figli input").val(0);for(i=1;i<=a;i++){jQuery("#imuc_eta_figlio_"+i+" input").val(b);jQuery("#imuc_eta_figlio_"+i).show()}});jQuery("#imuc-calcoloimu input").keypress(function(a){var b=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if(b==13)return false});jQuery("#form_n_figli,#form_contitolari,#form_mesi_possesso").keypress(function(a){var b=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if(b>31&&(b<48||b>57))return false;return true});jQuery("#imuc-calcoloimu input").keyup(function(){});jQuery("#imuc-calcoloimu input").change(function(){});jQuery("#form_quota_possesso").keyup(function(){var a=parseInt(jQuery(this).val());if(a>100){jQuery(this).val(100);a=100}if(a<0){jQuery(this).val(0);a=0}controlla_contitolari()});jQuery("#form_mesi_possesso").keyup(function(){var a=parseInt(jQuery(this).val());if(a>12){jQuery(this).val(12)}if(a<0){jQuery(this).val(1)}controllo_eta_figli()});jQuery("#form_coefficiente").change(function(){var a=jQuery(this).val();if(a=="C2"||a=="C6"||a=="C7"){jQuery("#label_prima_casa").html("Pertinenza di abitazione principale");jQuery("#label_prima_casa").css("line-height","normal")}else{jQuery("#label_prima_casa").html("Abitazione principale?");jQuery("#label_prima_casa").css("line-height","normal")}if(a!="A"){jQuery("#form_prima_casa_si").attr("checked",false);jQuery("#form_prima_casa_no").click();if(a=="C2"||a=="C6"||a=="C7"){jQuery("input[name=prima_casa]").change();if(!jQuery(".prima_casa").is(":visible")){jQuery(".prima_casa").show();jQuery("input[name=prima_casa]").change()}}else{if(jQuery(".prima_casa").is(":visible")){jQuery(".prima_casa,.figli").hide();jQuery("input[name=prima_casa]").change()}}}else{jQuery(".prima_casa,.figli").show();jQuery("#form_prima_casa_no").attr("checked",false);jQuery("#form_prima_casa_si").click();jQuery("input[name=prima_casa]").change()}if(a=="TA"||a=="AE"){jQuery(".detrazione_base_imponibile").hide();if(a=="TA"){jQuery(".coltivatore_diretto").show();jQuery("#label_rendita").html("Reddito dominicale")}else if(a=="AE"){jQuery("#label_rendita").html("Valore dell'area")}else{jQuery(".coltivatore_diretto").hide();jQuery("#label_rendita").html("Rendita catastale")}}else{jQuery(".detrazione_base_imponibile").show();jQuery(".coltivatore_diretto").hide();jQuery("#label_rendita").html("Rendita catastale")}jQuery("input[name=quota_possesso]").keyup();jQuery(".help-box").hide();jQuery(".help-box.default").show();variazione_aliquota()});jQuery("input[name=prima_casa]").change(function(){variazione_aliquota();if(jQuery("#form_prima_casa_si").is(":checked")&&jQuery("#form_coefficiente").val()=="A"){jQuery(".figli").show()}else{jQuery(".figli").hide()}controlla_contitolari()});jQuery(".aliquota_link").click(function(){var a=jQuery(this).attr("rel");var b=jQuery("#form_aliquota").val();if(a=="su"){b=(parseFloat(b)+.01).toFixed(2)}else{b=(parseFloat(b)-.01).toFixed(2)}variazione_aliquota(b);return false});jQuery("#form_coefficiente").change();jQuery("#imuc-calcoloimu").submit(function(){var a=jQuery("#form_rendita").val();if(a==undefined||a=="0,00"||a==0)return false})});jQuery.fn.tipbox=function(a,b,c){function e(a){d.css({display:"block",top:a.pageY+16,left:a.pageX})}function f(){d.css({display:"none"})}jQuery.fn.tipbox.created.id="imc_calculator_tipBox";jQuery("body").append(jQuery.fn.tipbox.created);var d=jQuery(jQuery.fn.tipbox.created);d.css({position:"absolute",display:"none"});this.each(function(){jQuery(this).mousemove(function(f){e(f);if(b)d.html(a);else d.text(a);d.removeClass();if(c)d.addClass(c)});jQuery(this).mouseout(function(){f()})})};jQuery.fn.tipbox.created=document.createElement("img")